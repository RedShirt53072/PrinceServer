Sub getRodData()
    Dim result As String
    result = ""
    For i = 3 To 1000
        Dim test As String
        test = Worksheets("釣り竿").Cells(i, 1).Value
        If test = "" Then
             Exit For
        End If
        result = result & getRod(i)
    Next i
    MsgBox "概要のI3にデータを出力しました。"
    Worksheets("概要").Cells(3, 9).Value = result
End Sub

Function getRod(ByVal index As Integer) As String
    Dim result As String
    result = "rod" & index & ":" & vbCrLf
    result = result & "  id: " & Worksheets("釣り竿").Cells(index, 2).Value & vbCrLf
    result = result & "  name: " & Worksheets("釣り竿").Cells(index, 1).Value & vbCrLf
    result = result & "  texture: " & Worksheets("釣り竿").Cells(index, 11).Value & vbCrLf
    result = result & getLore(index)
    result = result & "  rare1: " & Worksheets("釣り竿").Cells(index, 5).Value & vbCrLf
    result = result & "  rare2: " & Worksheets("釣り竿").Cells(index, 6).Value & vbCrLf
    result = result & "  rare3: " & Worksheets("釣り竿").Cells(index, 7).Value & vbCrLf
    result = result & "  rare4: " & Worksheets("釣り竿").Cells(index, 8).Value & vbCrLf
    result = result & "  rare5: " & Worksheets("釣り竿").Cells(index, 9).Value & vbCrLf
    getRod = result
End Function

Function getLore(ByVal index As Integer) As String
    Dim rawLore As String
    Dim result As String
    Dim length As Integer
    Dim remainder As Integer
    
    result = "  lore:" & vbCrLf
    rawLore = Worksheets("釣り竿").Cells(index, 3).Text
    
    length = Len(rawLore) \ 20
    remainder = Len(rawLore) Mod 20
    
    For i = 0 To length
        If length = i Then
            result = result & "    lore" & i + 1 & ": " & Mid(rawLore,i * 20 + 1,remainder) & vbCrLf
        Else
            result = result & "    lore" & i + 1 & ": " & Mid(rawLore,i * 20 + 1,20) & vbCrLf
        End If
    Next i
    getLore = result
End Function